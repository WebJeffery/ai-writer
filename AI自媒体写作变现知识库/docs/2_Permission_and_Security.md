# 权限管理与安全防护方案

## 1. 飞书知识库权限配置
基于飞书知识库的“精细化权限管控”功能，实现免费试读与付费隔离。

### A. 权限组设计 (User Groups)
我们在飞书管理后台创建以下用户组：

| 权限组名称 | 描述 | 成员来源 |
| :--- | :--- | :--- |
| **Visitors (游客)** | 仅注册未付费用户 | 默认所有进入知识库的用户 |
| **VIP_Members (付费会员)** | 已购买年卡的用户 | 通过API自动化添加 |
| **Admins (管理员)** | 运营团队/助教 | 手动添加 |

### B. 页面权限设置规则
在知识库设置中，针对不同目录层级应用以下规则：

1.  **知识库整体设置**：
    *   **可见性**：对组织内公开 / 对外公开（取决于是否使用企业版）。
    *   **默认权限**：只读。

2.  **目录级权限覆盖**：

| 目录 | 权限设置 | 目标受众 |
| :--- | :--- | :--- |
| **00_试读区** | **公开可见** (Public Read) | Visitors, VIP_Members, Admins |
| **01_基础篇** | **受限访问** (Restricted) | 仅 VIP_Members, Admins 可见 |
| **02_进阶篇** | **受限访问** (Restricted) | 仅 VIP_Members, Admins 可见 |
| **03_实战篇** | **受限访问** (Restricted) | 仅 VIP_Members, Admins 可见 |
| **04_资源中心** | **受限访问** (Restricted) | 仅 VIP_Members, Admins 可见 |

### C. 阶梯式解锁实现 (进阶功能)
若需实现“按学习进度解锁”（如学完基础篇才能看进阶篇），飞书原生暂不支持自动触发。
**替代方案**：
1.  利用自动化机器人，当学员在“基础篇”作业提交审批通过后，机器人自动将该学员加入 `VIP_Level2` 权限组。
2.  将“02_进阶篇”的权限设置为仅 `VIP_Level2` 可见。

---

## 2. 安全防护措施 (DLP & DRM)
为防止盗版和资料外泄，启用飞书文档的高级安全设置。

### A. 基础防复制机制
在知识库“安全设置”中开启：
- [x] **禁止复制/导出**：普通成员无法右键复制文字，无法导出为Word/PDF。
- [x] **禁止创建副本**：防止成员将文档另存为自己的私人文档。
- [x] **禁止打印**：禁用浏览器打印功能。

### B. 动态水印系统 (Watermark)
开启全局水印功能：
- **显示内容**：访问者的 `真实姓名 + 手机号后四位 + 当前时间`。
- **样式**：倾斜45度，浅灰色，高密度覆盖。
- **作用**：一旦发生截图外泄，可直接通过水印溯源追责，极大震慑盗版行为。

### C. 访问控制与审计
1.  **IP限制**（需企业版高级功能）：
    *   限制仅允许国内IP访问。
    *   检测到异常异地登录（如短时间内跨省登录）自动踢出并报警。
2.  **访问日志**：
    *   定期（每周）导出知识库访问日志。
    *   分析异常高频访问行为（如单日打开100+页面），识别潜在的爬虫或共享账号风险。

---

## 3. 会员生命周期管理
通过API实现自动踢出过期会员：
1.  **入库**：支付成功 -> API调用 -> 添加到 `VIP_Members` 组 -> 发送欢迎语。
2.  **到期**：每日定时任务检查 `expire_date` -> API调用 -> 从 `VIP_Members` 组移除 -> 发送续费提醒。
